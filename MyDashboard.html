<!-- External scripts/css -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
    crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
    .card {
        width: 15em;
    }
</style>

<!-- TEMPLATES -->
<div style="display:none;" id="listTemplate">
    <div class="list-group list-group-numbered">
        <!-- list items template copies get copied here -->
    </div>
</div>
<div style="display:none;" id="listItemTemplate">
    <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
            <div class="fw-bold" name="label"></div>
            <span name="description"></span>
        </div>
        <a class="btn btn-lg btn-primary" target="_blank" rel="noopener noreferrer" name="link" href="">
            <i class="bi bi-box-arrow-up-right"></i>
        </a>
    </li>
</div>
<div style="display:none" id="gridTemplate">
    <div class="row row-cols-1 row-cols-md-3 row-cols-lg-auto g-4 justify-content-center">
        <!-- cell template copies get copied here -->
    </div>
</div>
<div style="display:none" id="cellTemplate">
    <div class="col">
        <div class="card mx-auto">
            <div class="card-body">
                <h5 class="card-title" name="label"></h5>
                <p class="card-text" name="description"></p>
            </div>
            <div class="card-footer text-muted">
                <div class="d-grid gap-2">
                    <a class="btn btn-lg btn-primary" target="_blank" rel="noopener noreferrer" name="link" href="">
                        <i class="bi bi-box-arrow-up-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END TEMPLATES -->
<!-- Base Content -->
<div class="container-fluid px-3 py-3">
    <div class="h1 text-center">My Dashboard</div>
    <div class="justify-content-center mx-auto" style="width:5em">
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" role="switch" id="switch" onchange="onSwitchToggle(event)">
            <label class="form-check-label" for="switch">List/Grid</label>
        </div>
    </div>
    <div id="container" class="mx-auto" style="width:80%">
        <!-- will be generated -->
    </div>
</div>
<!-- End Base Content -->

<!-- "app" code -->
<script>
    //EDIT HERE
    //TODO copy the whole {}, add a comma after the last item, paste the content after and edit url, label, description accordingly
    const bookmarks = [{
        "url": "test",
        "label": "test",
        "description": "test"
    },
    ];
    //END EDIT
    //vars
    let gridSwitch = false;
    if (localStorage) {
        let v = localStorage.getItem("layout");
        gridSwitch = v === "grid";
        document.getElementById("switch").checked = gridSwitch;
    }
    //functions
    const makeHttps = (url) => {
        if (!url.startsWith('http://') && !url.startsWith('https://')) {
            return 'https://' + url;
        }
        return url;
    };
    const onSwitchToggle = (event) => {
        console.log("Switch", event);
        gridSwitch = !!event.srcElement.checked;
        event.srcElement.nextElementSibling.innerText = gridSwitch ? "Grid" : "List";
        if (localStorage) {
            localStorage.setItem("layout", (gridSwitch ? "grid" : "list"));
        }
        lazyReload();
    };

    const lazyReload = () => {
        let ele = document.getElementById("container");
        if (ele) {
            ele.innerHTML = "";//clear

            let container = document.getElementById((gridSwitch ? "gridTemplate" : "listTemplate")).cloneNode(true).children[0];
            container.style = "";
            let itemTemplate = document.getElementById((gridSwitch ? "cellTemplate" : "listItemTemplate")).children[0];
            bookmarks.forEach(b => {
                let item = itemTemplate.cloneNode(true);
                item.style = "";
                console.log("item", item);
                item.querySelector("[name=label]").innerHTML = b.label;
                item.querySelector("[name=description]").innerText = b.description;
                item.querySelector("[name=link]").href = makeHttps(b.url);
                container.appendChild(item);
            });
            ele.appendChild(container);
        }
    };
    //init
    lazyReload();


</script>